
/************************************************************************************************************
JS Calendar
Copyright (C) September 2006  DTHMLGoodies.com, Alf Magne Kalleland

This library is free software; you can redistribute it and/or
modify it under the terms of the GNU Lesser General Public
License as published by the Free Software Foundation; either
version 2.1 of the License, or (at your option) any later version.

This library is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public
License along with this library; if not, write to the Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA

Dhtmlgoodies.com., hereby disclaims all copyright interest in this script
written by Alf Magne Kalleland.

Alf Magne Kalleland, 2006
Owner of DHTMLgoodies.com
	
************************************************************************************************************/	
; var languageCode="en",calendar_display_time=!0,todayStringFormat="[todayString] [UCFdayString]. [day]. [monthString] [year]",pathToImages=base_url+"images/icons/",speedOfSelectBoxSliding=200,intervalSelectBox_minutes=5,calendar_offsetTop=0,calendar_offsetLeft=0,calendarDiv=!1,MSIE=!1,Opera=!1;0<=navigator.userAgent.indexOf("MSIE")&&0>navigator.userAgent.indexOf("Opera")&&(MSIE=!0);0<=navigator.userAgent.indexOf("Opera")&&(Opera=!0); switch(languageCode){case "en":var monthArray="January February March April May June July August September October November December".split(" "),monthArrayShort="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),dayArray="Mon Tue Wed Thu Fri Sat Su".split(" "),weekString="Wk",todayString="";break;case "ge":monthArray="Januar Februar M\ufffdrz April Mai Juni Juli August September Oktober November Dezember".split(" ");monthArrayShort="Jan Feb Mar Apr Mai Jun Jul Aug Sep Okt Nov Dez".split(" "); dayArray="Mon Die Mit Don Fre Sam Son".split(" ");weekString="Woche";todayString="Heute";break;case "no":monthArray="Januar Februar Mars April Mai Juni Juli August September Oktober November Desember".split(" ");monthArrayShort="Jan Feb Mar Apr Mai Jun Jul Aug Sep Okt Nov Des".split(" ");dayArray="Man Tir Ons Tor Fre L&oslash;r S&oslash;n".split(" ");weekString="Uke";todayString="Dagen i dag er";break;case "nl":monthArray="Januari Februari Maart April Mei Juni Juli Augustus September Oktober November December".split(" "); monthArrayShort="Jan Feb Mar Apr Mei Jun Jul Aug Sep Okt Nov Dec".split(" ");dayArray="Ma Di Wo Do Vr Za Zo".split(" ");weekString="Week";todayString="Vandaag";break;case "es":monthArray="Enero Febrero Marzo April Mayo Junio Julio Agosto Septiembre Octubre Noviembre Diciembre".split(" ");monthArrayShort="Ene Feb Mar Abr May Jun Jul Ago Sep Oct Nov Dic".split(" ");dayArray="Lun Mar Mie Jue Vie Sab Dom".split(" ");weekString="Semana";todayString="Hoy es";break;case "pt-br":monthArray="Janeiro Fevereiro Mar&ccedil;o Abril Maio Junho Julho Agosto Setembro Outubro Novembro Dezembro".split(" "); monthArrayShort="Jan Fev Mar Abr Mai Jun Jul Ago Set Out Nov Dez".split(" ");dayArray="Seg Ter Qua Qui Sex S&aacute;b Dom".split(" ");weekString="Sem.";todayString="Hoje &eacute;";break;case "fr":monthArray="Janvier F\ufffdvrier Mars Avril Mai Juin Juillet Ao\ufffdt Septembre Octobre Novembre D\ufffdcembre".split(" ");monthArrayShort="Jan Fev Mar Avr Mai Jun Jul Aou Sep Oct Nov Dec".split(" ");dayArray="Lun Mar Mer Jeu Ven Sam Dim".split(" ");weekString="Sem";todayString="Aujourd'hui";break;case "da":monthArray= "januar februar marts april maj juni juli august september oktober november december".split(" ");monthArrayShort="jan feb mar apr maj jun jul aug sep okt nov dec".split(" ");dayArray="man tirs ons tors fre l&oslash;r s&oslash;n".split(" ");weekString="Uge";todayString="I dag er den";break;case "hu":monthArray="Janu\u00e1r Febru\u00e1r M\u00e1rcius \ufffd?prilis M\u00e1jus J\u00fanius J\u00falius Augusztus Szeptember Okt\u00f3ber November December".split(" ");monthArrayShort="Jan Feb M\u00e1rc \ufffd?pr M\u00e1j J\u00fan J\u00fal Aug Szep Okt Nov Dec".split(" "); dayArray="H\u00e9 Ke Sze Cs P\u00e9 Szo Vas".split(" ");weekString="H\u00e9t";todayString="Mai nap";break;case "it":monthArray="Gennaio Febbraio Marzo Aprile Maggio Giugno Luglio Agosto Settembre Ottobre Novembre Dicembre".split(" ");monthArrayShort="Gen Feb Mar Apr Mag Giu Lugl Ago Set Ott Nov Dic".split(" ");dayArray="Lun ;Mar Mer Gio Ven Sab Dom".split(" ");weekString="Settimana";todayString="Oggi &egrave; il";break;case "sv":monthArray="Januari Februari Mars April Maj Juni Juli Augusti September Oktober November December".split(" "), monthArrayShort="Jan Feb Mar Apr Maj Jun Jul Aug Sep Okt Nov Dec".split(" "),dayArray="M&aring;n Tis Ons Tor Fre L&ouml;r S&ouml;n".split(" "),weekString="Vecka",todayString="Idag &auml;r det den"}var daysInMonthArray=[31,28,31,30,31,30,31,31,30,31,30,31],currentMonth,currentYear,currentHour,currentMinute,calendarContentDiv,returnDateTo,returnFormat,activeSelectBoxMonth,activeSelectBoxYear,activeSelectBoxHour,activeSelectBoxMinute,iframeObj=!1,iframeObj2=!1; function EIS_FIX_EI1(c){iframeObj2&&(iframeObj2.style.display="block",iframeObj2.style.height=document.getElementById(c).offsetHeight+1,iframeObj2.style.width=document.getElementById(c).offsetWidth,iframeObj2.style.left=getleftPos(document.getElementById(c))+1-calendar_offsetLeft,iframeObj2.style.top=getTopPos(document.getElementById(c))-document.getElementById(c).offsetHeight-calendar_offsetTop)}function EIS_Hide_Frame(){iframeObj2&&(iframeObj2.style.display="none")} var returnDateToYear,returnDateToMonth,returnDateToDay,returnDateToHour,returnDateToMinute,inputYear,inputMonth,inputDay,inputHour,inputMinute,calendarDisplayTime=!1,selectBoxHighlightColor="#D60808",selectBoxRolloverBgColor="#E6E6E6",selectBoxMovementInProgress=!1,activeSelectBox=!1;function cancelCalendarEvent(){return!1}function isLeapYear(c){return 0==c%400||0==c%4&&0!=c%100?!0:!1}var activeSelectBoxDirection=activeSelectBoxMonth=!1; function highlightMonthYear(){activeSelectBoxMonth&&(activeSelectBoxMonth.className="");activeSelectBox=this;"monthYearActive"==this.className?this.className="":(this.className="monthYearActive",activeSelectBoxMonth=this);0<=this.innerHTML.indexOf("-")||0<=this.innerHTML.indexOf("+")?(selectBoxMovementInProgress="monthYearActive"==this.className?!0:!1,activeSelectBoxDirection=0<=this.innerHTML.indexOf("-")?-1:1):selectBoxMovementInProgress=!1} function showMonthDropDown(){"block"==document.getElementById("monthDropDown").style.display?(document.getElementById("monthDropDown").style.display="none",EIS_Hide_Frame()):(document.getElementById("monthDropDown").style.display="block",document.getElementById("yearDropDown").style.display="none",document.getElementById("hourDropDown").style.display="none",document.getElementById("minuteDropDown").style.display="none",MSIE&&EIS_FIX_EI1("monthDropDown"))} function showYearDropDown(){"block"==document.getElementById("yearDropDown").style.display?(document.getElementById("yearDropDown").style.display="none",EIS_Hide_Frame()):(document.getElementById("yearDropDown").style.display="block",document.getElementById("monthDropDown").style.display="none",document.getElementById("hourDropDown").style.display="none",document.getElementById("minuteDropDown").style.display="none",MSIE&&EIS_FIX_EI1("yearDropDown"))} function showHourDropDown(){"block"==document.getElementById("hourDropDown").style.display?(document.getElementById("hourDropDown").style.display="none",EIS_Hide_Frame()):(document.getElementById("hourDropDown").style.display="block",document.getElementById("monthDropDown").style.display="none",document.getElementById("yearDropDown").style.display="none",document.getElementById("minuteDropDown").style.display="none",MSIE&&EIS_FIX_EI1("hourDropDown"))} function showMinuteDropDown(){"block"==document.getElementById("minuteDropDown").style.display?(document.getElementById("minuteDropDown").style.display="none",EIS_Hide_Frame()):(document.getElementById("minuteDropDown").style.display="block",document.getElementById("monthDropDown").style.display="none",document.getElementById("yearDropDown").style.display="none",document.getElementById("hourDropDown").style.display="none",MSIE&&EIS_FIX_EI1("minuteDropDown"))} function selectMonth(){document.getElementById("calendar_month_txt").innerHTML=this.innerHTML;currentMonth=this.id.replace(/[^\d]/g,"");document.getElementById("monthDropDown").style.display="none";EIS_Hide_Frame();for(var c=0;c<monthArray.length;c++)document.getElementById("monthDiv_"+c).style.color="";this.style.color=selectBoxHighlightColor;activeSelectBoxMonth=this;writeCalendarContent()} function selectHour(){document.getElementById("calendar_hour_txt").innerHTML=this.innerHTML;currentHour=this.innerHTML.replace(/[^\d]/g,"");document.getElementById("hourDropDown").style.display="none";EIS_Hide_Frame();activeSelectBoxHour&&(activeSelectBoxHour.style.color="");activeSelectBoxHour=this;this.style.color=selectBoxHighlightColor} function selectMinute(){document.getElementById("calendar_minute_txt").innerHTML=this.innerHTML;currentMinute=this.innerHTML.replace(/[^\d]/g,"");document.getElementById("minuteDropDown").style.display="none";EIS_Hide_Frame();activeSelectBoxMinute&&(activeSelectBoxMinute.style.color="");activeSelectBoxMinute=this;this.style.color=selectBoxHighlightColor} function selectYear(){document.getElementById("calendar_year_txt").innerHTML=this.innerHTML;currentYear=this.innerHTML.replace(/[^\d]/g,"");document.getElementById("yearDropDown").style.display="none";EIS_Hide_Frame();activeSelectBoxYear&&(activeSelectBoxYear.style.color="");activeSelectBoxYear=this;this.style.color=selectBoxHighlightColor;writeCalendarContent()} function switchMonth(){0<=this.src.indexOf("left")?(currentMonth-=1,0>currentMonth&&(currentMonth=11,currentYear-=1)):(currentMonth+=1,11<currentMonth&&(currentMonth=0,currentYear=currentYear/1+1));writeCalendarContent()} function createMonthDiv(){var c=document.createElement("DIV");c.className="monthYearPicker";c.id="monthPicker";for(var b=0;b<monthArray.length;b++){var a=document.createElement("DIV");a.innerHTML=monthArray[b];a.onmouseover=highlightMonthYear;a.onmouseout=highlightMonthYear;a.onclick=selectMonth;a.id="monthDiv_"+b;a.style.width="56px";a.onselectstart=cancelCalendarEvent;c.appendChild(a);currentMonth&&currentMonth==b&&(a.style.color=selectBoxHighlightColor,activeSelectBoxMonth=a)}return c} function changeSelectBoxYear(c,b){b||(b=this);var a=b.parentNode.getElementsByTagName("DIV"),d=0<=b.innerHTML.indexOf("-")?a[1].innerHTML/1-1:a[1].innerHTML/1+1;activeSelectBoxYear&&(activeSelectBoxYear.style.color="");for(var f=1;f<a.length-1;f++)a[f].innerHTML=d+f-1,a[f].id="yearDiv"+(d/1+f/1-1);activeSelectBoxYear&&(activeSelectBoxYear.style.color="",document.getElementById("yearDiv"+currentYear)&&(activeSelectBoxYear=document.getElementById("yearDiv"+currentYear),activeSelectBoxYear.style.color= selectBoxHighlightColor))} function changeSelectBoxHour(c,b){b||(b=this);var a=b.parentNode.getElementsByTagName("DIV");if(0<=b.innerHTML.indexOf("-")){var d=a[1].innerHTML/1-1;0>d&&(d=0)}else d=a[1].innerHTML/1+1,14<d&&(d=14);activeSelectBoxHour&&(activeSelectBoxHour.style.color="");for(var f="",e=1;e<a.length-1;e++)f=11>d/1+e/1?"0":"",a[e].innerHTML=f+(d+e-1),a[e].id="hourDiv"+(d/1+e/1-1);activeSelectBoxHour&&(activeSelectBoxHour.style.color="",document.getElementById("hourDiv"+currentHour)&&(activeSelectBoxHour=document.getElementById("hourDiv"+ currentHour),activeSelectBoxHour.style.color=selectBoxHighlightColor))}function updateYearDiv(){for(var c=document.getElementById("yearDropDown").getElementsByTagName("DIV"),b=1;b<c.length-1;b++)c[b].innerHTML=currentYear/1-6+b,currentYear==currentYear/1-6+b?(c[b].style.color=selectBoxHighlightColor,activeSelectBoxYear=c[b]):c[b].style.color=""} function updateMonthDiv(){for(no=0;12>no;no++)document.getElementById("monthDiv_"+no).style.color="";document.getElementById("monthDiv_"+currentMonth).style.color=selectBoxHighlightColor;activeSelectBoxMonth=document.getElementById("monthDiv_"+currentMonth)} function updateHourDiv(){var c=document.getElementById("hourDropDown").getElementsByTagName("DIV"),b=0;0>currentHour/1-6+1&&(b=-1*(currentHour/1-6+1));for(var a=1;a<c.length-1;a++){var d="";10>currentHour/1-6+a+b&&(d="0");c[a].innerHTML=d+(currentHour/1-6+a+b);currentHour==currentHour/1-6+a?(c[a].style.color=selectBoxHighlightColor,activeSelectBoxHour=c[a]):c[a].style.color=""}} function updateMinuteDiv(){for(no=0;60>no;no+=intervalSelectBox_minutes){var c="";10>no&&(c="0");document.getElementById("minuteDiv_"+c+no).style.color=""}document.getElementById("minuteDiv_"+currentMinute)&&(document.getElementById("minuteDiv_"+currentMinute).style.color=selectBoxHighlightColor,activeSelectBoxMinute=document.getElementById("minuteDiv_"+currentMinute))} function createYearDiv(){if(document.getElementById("yearDropDown"))for(var c=document.getElementById("yearDropDown"),b=c.getElementsByTagName("DIV"),a=0;a<b.length;a++)b[a].parentNode.removeChild(b[a]);else{var c=document.createElement("DIV");c.className="monthYearPicker"}a=new Date;currentYear&&a.setFullYear(currentYear);var b=a.getFullYear()/1-5,d=document.createElement("DIV");d.innerHTML="&nbsp;&nbsp;- ";d.onclick=changeSelectBoxYear;d.onmouseover=highlightMonthYear;d.onmouseout=function(){selectBoxMovementInProgress= !1};d.onselectstart=cancelCalendarEvent;c.appendChild(d);for(a=b;a<b+10;a++)d=document.createElement("DIV"),d.innerHTML=a,d.onmouseover=highlightMonthYear,d.onmouseout=highlightMonthYear,d.onclick=selectYear,d.id="yearDiv"+a,d.onselectstart=cancelCalendarEvent,c.appendChild(d),currentYear&&currentYear==a&&(d.style.color=selectBoxHighlightColor,activeSelectBoxYear=d);d=document.createElement("DIV");d.innerHTML="&nbsp;&nbsp;+ ";d.onclick=changeSelectBoxYear;d.onmouseover=highlightMonthYear;d.onmouseout= function(){selectBoxMovementInProgress=!1};d.onselectstart=cancelCalendarEvent;c.appendChild(d);return c}function slideCalendarSelectBox(){selectBoxMovementInProgress&&("hourDropDown"==activeSelectBox.parentNode.id&&changeSelectBoxHour(!1,activeSelectBox),"yearDropDown"==activeSelectBox.parentNode.id&&changeSelectBoxYear(!1,activeSelectBox));setTimeout("slideCalendarSelectBox()",speedOfSelectBoxSliding)} function createHourDiv(){if(document.getElementById("hourDropDown"))for(var c=document.getElementById("hourDropDown"),b=c.getElementsByTagName("DIV"),a=0;a<b.length;a++)b[a].parentNode.removeChild(b[a]);else{var c=document.createElement("DIV");c.className="monthYearPicker"}currentHour||(currentHour=0);b=currentHour/1;14<b&&(b=14);var d=document.createElement("DIV");d.innerHTML="&nbsp;&nbsp;- ";d.onclick=changeSelectBoxHour;d.onmouseover=highlightMonthYear;d.onmouseout=function(){selectBoxMovementInProgress= !1};d.onselectstart=cancelCalendarEvent;c.appendChild(d);for(a=b;a<b+10;a++){var f="";10>a/1&&(f="0");d=document.createElement("DIV");d.innerHTML=f+a;d.onmouseover=highlightMonthYear;d.onmouseout=highlightMonthYear;d.onclick=selectHour;d.id="hourDiv"+a;d.onselectstart=cancelCalendarEvent;c.appendChild(d);currentYear&&currentYear==a&&(d.style.color=selectBoxHighlightColor,activeSelectBoxYear=d)}d=document.createElement("DIV");d.innerHTML="&nbsp;&nbsp;+ ";d.onclick=changeSelectBoxHour;d.onmouseover= highlightMonthYear;d.onmouseout=function(){selectBoxMovementInProgress=!1};d.onselectstart=cancelCalendarEvent;c.appendChild(d);return c} function createMinuteDiv(){if(document.getElementById("minuteDropDown"))for(var c=document.getElementById("minuteDropDown"),b=c.getElementsByTagName("DIV"),a=0;a<b.length;a++)b[a].parentNode.removeChild(b[a]);else{var c=document.createElement("DIV");c.className="monthYearPicker"}b="";for(a=0;60>a;a+=intervalSelectBox_minutes){var b=10>a?"0":"",d=document.createElement("DIV");d.innerHTML=b+a;d.onmouseover=highlightMonthYear;d.onmouseout=highlightMonthYear;d.onclick=selectMinute;d.id="minuteDiv_"+b+ a;d.onselectstart=cancelCalendarEvent;c.appendChild(d);currentYear&&currentYear==a&&(d.style.color=selectBoxHighlightColor,activeSelectBoxYear=d)}return c} function highlightSelect(){"selectBoxTime"==this.className?(this.className="selectBoxTimeOver",this.getElementsByTagName("IMG")[0].src=pathToImages+"down_time_over.gif"):"selectBoxTimeOver"==this.className&&(this.className="selectBoxTime",this.getElementsByTagName("IMG")[0].src=pathToImages+"down_time.gif");"selectBox"==this.className?(this.className="selectBoxOver",this.getElementsByTagName("IMG")[0].src=pathToImages+"down_over.gif"):"selectBoxOver"==this.className&&(this.className="selectBox",this.getElementsByTagName("IMG")[0].src= pathToImages+"down.gif")}function highlightArrow(){0<=this.src.indexOf("over")?(0<=this.src.indexOf("left")&&(this.src=pathToImages+"left.gif"),0<=this.src.indexOf("right")&&(this.src=pathToImages+"right.gif")):(0<=this.src.indexOf("left")&&(this.src=pathToImages+"left_over.gif"),0<=this.src.indexOf("right")&&(this.src=pathToImages+"right_over.gif"))}function highlightClose(){this.src=0<=this.src.indexOf("over")?pathToImages+"close.gif":pathToImages+"close_over.gif"} function closeCalendar(){document.getElementById("yearDropDown").style.display="none";document.getElementById("monthDropDown").style.display="none";document.getElementById("hourDropDown").style.display="none";document.getElementById("minuteDropDown").style.display="none";calendarDiv.style.display="none";iframeObj&&(iframeObj.style.display="none",EIS_Hide_Frame());activeSelectBoxMonth&&(activeSelectBoxMonth.className="");activeSelectBoxYear&&(activeSelectBoxYear.className="")} function writeTopBar(){var c=document.createElement("DIV");c.className="topBar";c.id="topBar";calendarDiv.appendChild(c);var b=document.createElement("DIV");b.style.marginRight="1px";var a=document.createElement("IMG");a.src=pathToImages+"left.gif";a.onmouseover=highlightArrow;a.onclick=switchMonth;a.onmouseout=highlightArrow;b.appendChild(a);c.appendChild(b);Opera&&(b.style.width="16px");b=document.createElement("DIV");b.style.marginRight="1px";a=document.createElement("IMG");a.src=pathToImages+ "right.gif";a.onclick=switchMonth;a.onmouseover=highlightArrow;a.onmouseout=highlightArrow;b.appendChild(a);Opera&&(b.style.width="16px");c.appendChild(b);b=document.createElement("DIV");b.id="monthSelect";b.onmouseover=highlightSelect;b.onmouseout=highlightSelect;b.onclick=showMonthDropDown;a=document.createElement("SPAN");a.innerHTML=monthArray[currentMonth];a.id="calendar_month_txt";b.appendChild(a);a=document.createElement("IMG");a.src=pathToImages+"down.gif";a.style.position="absolute";a.style.right= "0px";b.appendChild(a);b.className="selectBox";Opera&&(a.style.cssText="float:right;position:relative",a.style.position="relative",a.style.styleFloat="right");c.appendChild(b);a=createMonthDiv();a.style.left="37px";a.style.top=b.offsetTop+b.offsetHeight+1+"px";a.style.width="60px";a.id="monthDropDown";calendarDiv.appendChild(a);var d=document.createElement("DIV");d.onmouseover=highlightSelect;d.onmouseout=highlightSelect;d.onclick=showYearDropDown;a=document.createElement("SPAN");a.innerHTML=currentYear; a.id="calendar_year_txt";d.appendChild(a);c.appendChild(d);a=document.createElement("IMG");a.src=pathToImages+"down.gif";d.appendChild(a);d.className="selectBox";Opera&&(d.style.width="50px",a.style.cssText="float:right",a.style.position="relative",a.style.styleFloat="right");a=createYearDiv();a.style.left="113px";a.style.top=b.offsetTop+b.offsetHeight+1+"px";a.style.width="35px";a.id="yearDropDown";calendarDiv.appendChild(a);a=document.createElement("IMG");a.src=pathToImages+"close.gif";a.style.styleFloat= "right";a.onmouseover=highlightClose;a.onmouseout=highlightClose;a.onclick=closeCalendar;c.appendChild(a);document.all||(a.style.position="absolute",a.style.right="2px")} function writeCalendarContent(){var c=!0;calendarContentDiv||(calendarContentDiv=document.createElement("DIV"),calendarDiv.appendChild(calendarContentDiv),c=!1);currentMonth/=1;var b=new Date;b.setFullYear(currentYear);b.setDate(1);b.setMonth(currentMonth);var a=b.getDay();0==a&&(a=7);a--;document.getElementById("calendar_year_txt").innerHTML=currentYear;document.getElementById("calendar_month_txt").innerHTML=monthArray[currentMonth];document.getElementById("calendar_hour_txt").innerHTML=currentHour; document.getElementById("calendar_minute_txt").innerHTML=currentMinute;var d=calendarContentDiv.getElementsByTagName("TABLE");0<d.length&&calendarContentDiv.removeChild(d[0]);var f=document.createElement("TABLE");f.width="100%";f.cellSpacing="0";calendarContentDiv.appendChild(f);d=document.createElement("TBODY");f.appendChild(d);f=d.insertRow(-1);f.className="calendar_week_row";var e=f.insertCell(-1);e.innerHTML=weekString;e.className="calendar_week_column";e.style.backgroundColor=selectBoxRolloverBgColor; for(var g=0;g<dayArray.length;g++)e=f.insertCell(-1),e.innerHTML=dayArray[g];f=d.insertRow(-1);e=f.insertCell(-1);e.className="calendar_week_column";e.style.backgroundColor=selectBoxRolloverBgColor;var h=getWeek(currentYear,currentMonth,1);e.innerHTML=h;for(g=0;g<a;g++)e=f.insertCell(-1),e.innerHTML="&nbsp;";var j=daysInMonthArray[currentMonth];28==j&&isLeapYear(currentYear)&&(j=29);for(g=1;g<=j;g++)b.setDate(g-1),0<a&&0==a%7&&(f=d.insertRow(-1),e=f.insertCell(-1),e.className="calendar_week_column", h=getWeek(currentYear,currentMonth,g),e.innerHTML=h,e.style.backgroundColor=selectBoxRolloverBgColor),e=f.insertCell(-1),currentYear==inputYear&&(currentMonth==inputMonth&&g==inputDay)&&(e.className="activeDay"),e.innerHTML=g,e.onclick=pickDate,a++;document.all||(calendarContentDiv.offsetHeight?document.getElementById("topBar").style.top=calendarContentDiv.offsetHeight+document.getElementById("timeBar").offsetHeight+document.getElementById("topBar").offsetHeight-1+"px":(document.getElementById("topBar").style.top= "",document.getElementById("topBar").style.bottom="0px"));iframeObj&&(c?setTimeout("resizeIframe()",10):setTimeout("resizeIframe()",350))}function resizeIframe(){iframeObj.style.width=calendarDiv.offsetWidth+"px";iframeObj.style.height=calendarDiv.offsetHeight+"px"}function pickTodaysDate(){var c=new Date;currentMonth=c.getMonth();currentYear=c.getFullYear();pickDate(!1,c.getDate())} function pickDate(c,b){var a=currentMonth/1+1;10>a&&(a="0"+a);var d;d=!b&&this?this.innerHTML:b;10>d/1&&(d="0"+d);if(returnFormat){returnFormat=returnFormat.replace("dd",d);returnFormat=returnFormat.replace("mm",a);returnFormat=returnFormat.replace("yyyy",currentYear);returnFormat=returnFormat.replace("hh",currentHour);returnFormat=returnFormat.replace("ii",currentMinute);returnFormat=returnFormat.replace("d",d/1);returnFormat=returnFormat.replace("m",a/1);returnDateTo.value=returnFormat;try{returnDateTo.onchange()}catch(f){}}else{for(var e= 0;e<returnDateToYear.options.length;e++)if(returnDateToYear.options[e].value==currentYear){returnDateToYear.selectedIndex=e;break}for(e=0;e<returnDateToMonth.options.length;e++)if(returnDateToMonth.options[e].value==a){returnDateToMonth.selectedIndex=e;break}for(e=0;e<returnDateToDay.options.length;e++)if(returnDateToDay.options[e].value==d){returnDateToDay.selectedIndex=e;break}if(calendarDisplayTime){for(e=0;e<returnDateToHour.options.length;e++)if(returnDateToHour.options[e].value==currentHour){returnDateToHour.selectedIndex= e;break}for(e=0;e<returnDateToMinute.options.length;e++)if(returnDateToMinute.options[e].value==currentMinute){returnDateToMinute.selectedIndex=e;break}}}closeCalendar()}function getWeek(c,b,a){b=b/1+1;var d=Math.floor((14-b)/12);c=c/1+4800-d;b=a/1+Math.floor((153*(b+12*d-3)+2)/5)+365*c+Math.floor(c/4)-Math.floor(c/100)+Math.floor(c/400)-32045;b=(b+31741-b%7)%146097%36524%1461;a=Math.floor(b/1460);return NumberOfWeek=Math.floor(((b-a)%365+a)/7)+1} function writeTimeBar(){var c=document.createElement("DIV");c.id="timeBar";c.className="timeBar";document.createElement("DIV").innerHTML="Time:";var b=document.createElement("DIV");b.onmouseover=highlightSelect;b.onmouseout=highlightSelect;b.onclick=showHourDropDown;b.style.width="30px";var a=document.createElement("SPAN");a.innerHTML=currentHour;a.id="calendar_hour_txt";b.appendChild(a);c.appendChild(b);a=document.createElement("IMG");a.src=pathToImages+"down_time.gif";b.appendChild(a);b.className= "selectBoxTime";Opera&&(b.style.width="30px",a.style.cssText="float:right",a.style.position="relative",a.style.styleFloat="right");b=createHourDiv();b.style.left="130px";b.style.width="35px";b.id="hourDropDown";calendarDiv.appendChild(b);b=document.createElement("DIV");b.onmouseover=highlightSelect;b.onmouseout=highlightSelect;b.onclick=showMinuteDropDown;b.style.width="30px";a=document.createElement("SPAN");a.innerHTML=currentMinute;a.id="calendar_minute_txt";b.appendChild(a);c.appendChild(b);a= document.createElement("IMG");a.src=pathToImages+"down_time.gif";b.appendChild(a);b.className="selectBoxTime";Opera&&(b.style.width="30px",a.style.cssText="float:right",a.style.position="relative",a.style.styleFloat="right");b=createMinuteDiv();b.style.left="167px";b.style.width="35px";b.id="minuteDropDown";calendarDiv.appendChild(b);return c} function writeBottomBar(){var c=new Date,b=document.createElement("DIV");b.id="bottomBar";b.style.cursor="pointer";b.className="todaysDate";var a=document.createElement("DIV");a.onclick=pickTodaysDate;a.id="todaysDateString";a.style.width=calendarDiv.offsetWidth-95+"px";var d=c.getDay();0==d&&(d=7);d--;var f=todayStringFormat,f=f.replace("[monthString]",monthArrayShort[c.getMonth()]),f=f.replace("[day]",c.getDate()),f=f.replace("[year]",c.getFullYear()),f=f.replace("[dayString]",dayArray[d].toLowerCase()), f=f.replace("[UCFdayString]",dayArray[d]),f=f.replace("[todayString]",todayString);a.innerHTML=todayString+": "+c.getDate()+". "+monthArrayShort[c.getMonth()]+", "+c.getFullYear();a.innerHTML=f;b.appendChild(a);c=writeTimeBar();b.appendChild(c);calendarDiv.appendChild(b)}function getTopPos(c){for(var b=c.offsetTop+c.offsetHeight;null!=(c=c.offsetParent);)b+=c.offsetTop;return b+calendar_offsetTop} function getleftPos(c){for(var b=c.offsetLeft;null!=(c=c.offsetParent);)b+=c.offsetLeft;return b+calendar_offsetLeft}function positionCalendar(c){calendarDiv.style.left=getleftPos(c)+"px";calendarDiv.style.top=getTopPos(c)+"px";iframeObj&&(iframeObj.style.left=calendarDiv.style.left,iframeObj.style.top=calendarDiv.style.top,iframeObj2.style.left=calendarDiv.style.left,iframeObj2.style.top=calendarDiv.style.top)} function initCalendar(){MSIE&&(iframeObj=document.createElement("IFRAME"),iframeObj.style.filter="alpha(opacity=0)",iframeObj.style.position="absolute",iframeObj.border="0px",iframeObj.style.border="0px",iframeObj.style.backgroundColor="#FF0000",iframeObj2=document.createElement("IFRAME"),iframeObj2.style.position="absolute",iframeObj2.border="0px",iframeObj2.style.border="0px",iframeObj2.style.height="1px",iframeObj2.style.width="1px",document.body.appendChild(iframeObj2),iframeObj2.src="blank.html", iframeObj.src="blank.html",document.body.appendChild(iframeObj));calendarDiv=document.createElement("DIV");calendarDiv.id="calendarDiv";calendarDiv.style.zIndex=1E4;slideCalendarSelectBox();document.body.appendChild(calendarDiv);writeBottomBar();writeTopBar();if(!currentYear){var c=new Date;currentMonth=c.getMonth();currentYear=c.getFullYear()}writeCalendarContent()} function setTimeProperties(){calendarDisplayTime?(document.getElementById("timeBar").style.display="block",document.getElementById("timeBar").style.visibility="visible",document.getElementById("hourDropDown").style.top=document.getElementById("calendar_minute_txt").parentNode.offsetHeight+calendarContentDiv.offsetHeight+document.getElementById("topBar").offsetHeight+"px",document.getElementById("minuteDropDown").style.top=document.getElementById("calendar_minute_txt").parentNode.offsetHeight+calendarContentDiv.offsetHeight+ document.getElementById("topBar").offsetHeight+"px",document.getElementById("minuteDropDown").style.right="50px",document.getElementById("hourDropDown").style.right="50px",document.getElementById("todaysDateString").style.width="115px"):(document.getElementById("timeBar").style.display="none",document.getElementById("timeBar").style.visibility="hidden",document.getElementById("todaysDateString").style.width="100%")}function calendarSortItems(c,b){return c/1-b/1} function displayCalendar(c,b,a,d){calendarDisplayTime=d?!0:!1;if(0<c.value.length)if(b.match(/^[0-9]*?$/gi))d=b.indexOf("mm"),currentMonth=c.value.substr(d,2)/1-1,d=b.indexOf("yyyy"),currentYear=c.value.substr(d,4),d=b.indexOf("dd"),tmpDay=c.value.substr(d,2),d=b.indexOf("hh"),currentHour=0<=d?tmpHour=c.value.substr(d,2):"00",d=b.indexOf("ii"),currentMinute=0<=d?tmpMinute=c.value.substr(d,2):"00";else{d=c.value.split(/[^0-9]/gi);var f=[];f.m=b.indexOf("mm");-1==f.m&&(f.m=b.indexOf("m"));f.d=b.indexOf("dd"); -1==f.d&&(f.d=b.indexOf("d"));f.y=b.indexOf("yyyy");f.h=b.indexOf("hh");f.i=b.indexOf("ii");var e=[];e[0]=f.m;e[1]=f.d;e[2]=f.y;e[3]=f.h;e[4]=f.i;var e=e.sort(calendarSortItems),g=-1;currentMinute=currentHour="00";for(var h=0;h<e.length;h++)-1!=e[h]&&(g++,e[h]==f.m?currentMonth=d[g]-1:e[h]==f.y?currentYear=d[g]:e[h]==f.d?tmpDay=d[g]:e[h]==f.h?currentHour=d[g]:e[h]==f.i&&(currentMinute=d[g]));currentMonth/=1;tmpDay/=1}else d=new Date,currentMonth=d.getMonth(),currentYear=d.getFullYear(),currentHour= "08",currentMinute="00",tmpDay=d.getDate();inputYear=currentYear;inputMonth=currentMonth;inputDay=tmpDay/1;if(calendarDiv){if("block"==calendarDiv.style.display)return closeCalendar(),!1;writeCalendarContent()}else initCalendar();returnFormat=b;returnDateTo=c;positionCalendar(a);calendarDiv.style.visibility="visible";calendarDiv.style.display="block";iframeObj&&(iframeObj.style.display="",iframeObj.style.height="140px",iframeObj.style.width="195px",iframeObj2.style.display="",iframeObj2.style.height= "140px",iframeObj2.style.width="195px");setTimeProperties();updateYearDiv();updateMonthDiv();updateMinuteDiv();updateHourDiv()} function displayCalendarSelectBox(c,b,a,d,f,e){calendarDisplayTime=d?!0:!1;currentMonth=b.options[b.selectedIndex].value/1-1;currentYear=c.options[c.selectedIndex].value;d&&(currentHour=d.options[d.selectedIndex].value,inputHour=currentHour/1);f&&(currentMinute=f.options[f.selectedIndex].value,inputMinute=currentMinute/1);inputYear=c.options[c.selectedIndex].value;inputMonth=b.options[b.selectedIndex].value/1-1;inputDay=a.options[a.selectedIndex].value/1;calendarDiv?writeCalendarContent():initCalendar(); returnDateToYear=c;returnDateToMonth=b;returnDateToDay=a;returnDateToHour=d;returnDateToMinute=f;returnDateTo=returnFormat=!1;positionCalendar(e);calendarDiv.style.visibility="visible";calendarDiv.style.display="block";iframeObj&&(iframeObj.style.display="",iframeObj.style.height=calendarDiv.offsetHeight+"px",iframeObj.style.width=calendarDiv.offsetWidth+"px",iframeObj2.style.display="",iframeObj2.style.height=calendarDiv.offsetHeight+"px",iframeObj2.style.width=calendarDiv.offsetWidth+"px");setTimeProperties(); updateYearDiv();updateMonthDiv();updateHourDiv();updateMinuteDiv()}function ltrim(c){for(var b=0;b<c.length&&isWhitespace(c.charAt(b));b++);return c.substring(b,c.length)}function rtrim(c){for(var b=c.length-1;0<=b&&isWhitespace(c.charAt(b));b--);return c.substring(0,b+1)}function trim(c){return ltrim(rtrim(c))}function isAlphaNumeric(c){return c.match(/^[a-zA-Z0-9]+$/)?!0:!1}function isWhitespace(c){return-1!=" \t\n\r\f".indexOf(c)} function __fncCheckEMail(c,b){/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i.test(c)?testres=!0:(alert(b),testres=!1);return testres};